<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="TmsProgrmManage">

	<typeAlias  alias="comDefaultVO" type="egovframework.com.cmm.ComDefaultVO"/>
	<typeAlias  alias="egovMap" type="egovframework.rte.psl.dataaccess.util.EgovMap"/>
	<typeAlias  alias="TmsProgrmManageVO" type="egovframework.let.sym.prm.service.TmsProgrmManageVO"/>
	<typeAlias  alias="TmsProjectManageVO" type="egovframework.let.sym.prm.service.TmsProjectManageVO"/>
	<typeAlias  alias="TmsCommonManageVO" type="egovframework.let.sym.prm.service.TmsCommonManageVO"/>

    <!-- 프로그램목록 관리 -->
	<resultMap id="TmsProgrmManage"       class="egovframework.let.sym.prm.service.TmsProgrmManageVO">
		<result property="PG_ID"    column="PG_ID"    columnIndex="1"/>
		<result property="USER_DEV_ID"  column="USER_DEV_ID"  columnIndex="2"/>
		<result property="PG_NM"  column="PG_NM"  columnIndex="3"/>
		<result property="SYS_GB"        column="SYS_GB"        columnIndex="4"/>
		<result property="TASK_GB"             column="TASK_GB"             columnIndex="5"/>
		<result property="USE_YN"             column="USE_YN"             columnIndex="5"/>
		<result property="PJT_ID"             column="PJT_ID"             columnIndex="5"/>
	</resultMap> 
 <!-- 프로젝트 정보 관리 -->
	<resultMap id="TmsProjectManageVO"       class="egovframework.let.sym.prm.service.TmsProjectManageVO">
		<result property="PJT_ID"    column="PJT_ID"    columnIndex="1"/>
	</resultMap> 
	
	
	<select id="TmsProgrmManageDAO.selectProgrmList_D" parameterClass="comDefaultVO" resultMap="TmsProgrmManage">
		<![CDATA[
			SELECT 
				  PG_ID   AS "PG_ID"
				, (SELECT USER_NM FROM USER_TB WHERE USER_ID = USER_DEV_ID) AS "USER_DEV_ID"
				, PG_NM  AS "PG_NM" 
				, (SELECT CODE_NM FROM LETTCCMMNDETAILCODE WHERE CODE = SYS_GB) AS "SYS_GB" 
				, (SELECT CODE_NM FROM LETTCCMMNDETAILCODE WHERE CODE = TASK_GB) AS "TASK_GB"
				, USE_YN              AS "USE_YN"
				, PJT_ID              AS "PJT_ID"
			FROM LETTCCMMNDETAILCODE, PG_TB
			WHERE binary(PG_NM) like  CONCAT('%', #searchKeyword#, '%') AND SYS_GB = CODE
			LIMIT  #recordCountPerPage# OFFSET #firstIndex#
		 ]]>
	</select> 

	<!-- 총건수 조회 -->
	<select id="TmsProgrmManageDAO.selectProgrmListTotCnt_S" parameterClass="comDefaultVO" resultClass="int">
		<![CDATA[
		SELECT COUNT(*) AS totcnt
		  FROM LETTCCMMNDETAILCODE A, PG_TB B
		 WHERE binary(PG_NM) like  CONCAT('%', #searchKeyword#, '%') AND SYS_GB = CODE
		]]>
	</select>
	<!-- 프로그램 정보 조회 -->
	<select id="TmsProgrmManageDAO.selectProject" resultMap="TmsProjectManageVO">
		<![CDATA[
			SELECT 
				  PJT_ID   AS "PJT_ID"
			FROM PJT_TB
		 ]]>
	</select>
	
	<!-- 시스템구분 조회 -->
	<select id="TmsProgrmManageDAO.selectSysGb" resultClass="TmsProgrmManageVO">
			SELECT CODE_NM AS "SYS_GB" FROM LETTCCMMNDETAILCODE WHERE CODE_ID = 'SYSGB'
	</select>
	
	<!-- 업무구분 조회 -->
	<select id="TmsProgrmManageDAO.selectTaskGb" resultClass="TmsProgrmManageVO">
			SELECT CODE_NM AS "TASK_GB" FROM LETTCCMMNDETAILCODE WHERE CODE_ID = 'TASKGB'
	</select>  
	
	<!-- 업무구분 조회 -->
	<select id="TmsProgrmManageDAO.selectTaskGbSearch" resultClass="TmsProgrmManageVO">
		SELECT CODE_NM AS "TASK_GB"
		FROM LETTCCMMNDETAILCODE
		WHERE PARENT = (SELECT CODE
		FROM LETTCCMMNDETAILCODE
		WHERE CODE_NM = (SELECT CODE_NM  FROM LETTCCMMNDETAILCODE WHERE binary(CODE_NM)= #searchData#))
	</select> 

</sqlMap>                            